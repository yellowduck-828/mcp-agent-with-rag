# MCP Agent with RAG Tool
  
本项目实现了一个 **基于 MCP（Model Context Protocol）的可扩展 Agent 系统**，  
核心目标是展示 **Agent 如何在统一协议下调度本地工具与外部工具，并完成复杂任务**。

---

## ✨ 项目特点

- 基于 **MCP 的工具调度型 Agent 架构**
- 同时支持 **本地工具（Local Tools）与远程 MCP 工具**
- RAG 作为 **可调用工具** 而非内嵌逻辑

---

## 🔧 Tool 体系说明

本项目采用 MCP（Model Context Protocol）风格的工具机制，
Agent 可以在对话过程中按需调用不同类型的工具来完成任务。

目前支持两类工具：
- **本地工具（Local Tools）**：项目内直接实现
- **远程工具（Remote MCP Tools）**：通过 MCP 协议接入第三方工具服务

### 1️⃣ 本地工具（Local Tools）

Agent 可以直接调用项目中实现的本地工具，
这些工具统一放置在 `tools/` 目录下，由 MCP Server 注册后暴露给 Agent 使用。

当前已实现的本地工具包括：

- `cookbook_rag.py`  
  基于本地向量索引的 RAG 检索工具（以菜谱数据为示例）。
  
  主要用于演示完整的 RAG 流程，包括：
  - 文档加载与切分
  - 向量化（Embedding）
  - 相似度检索
  - 检索结果返回给 Agent 作为上下文

- `web_search.py`  
  基于 **Tavily API** 的网页搜索工具。  
  Agent 可以通过该工具进行实时网页搜索，用于补充最新信息或外部知识。

- `datetime.py`  
  获取当前系统时间，用于时间相关的推理或回答。

- `file.py`  
  本地文件读写工具，支持的操作包括：

  - 列出目录内容
  - 读取文本文件
  - 覆盖写入文件
  - 追加写入文件
  - 删除文件
  - 重命名 / 移动文件
  - 创建目录

  **所有文件操作仅允许在 `workspace/` 目录下进行。** 因此，即使 Agent 被错误调用或输入异常，也无法访问或修改宿主系统的任何其他文件，从而保证文件系统的安全性。

  另外，项目支持**从前端上传文件**，并将文件保存至 `workspace/` 目录中。


---

### 2️⃣ 远程工具（Remote MCP Tools）

除了本地工具外，本项目也支持通过 MCP 协议接入第三方工具服务。

Agent 可以调用部署在远端的 MCP Server，
例如来自 mcp.so 等平台的工具。

目前示例中接入了：

- 网页搜索类工具
- 高德地图 MCP 工具

用于演示 Agent 同时使用本地工具与远程工具的能力。

---

## 🧠 关于 RAG 的设计选择

在本项目中，RAG **并未直接写入 Agent 核心逻辑**，而是：

> **作为一个独立 Tool 被 Agent 调用**

也就是说，Agent 本身并不“内置”检索流程，而是在需要外部知识时，主动调用对应的 RAG 工具。

这样做主要基于以下考虑：

- Agent 只负责决策与调度，避免将检索细节耦合进对话逻辑
- 不同场景可以接入不同的 RAG 实现，而无需改动 Agent 本身
- RAG 模块可以单独调试、替换或升级（例如更换 embedding / 索引方案）

这种设计保留了 Agent 对 **何时检索、是否检索、检索哪个工具** 的控制权，以便在复杂任务中进行更灵活的组合与扩展。

---

## 📦 数据说明

RAG 使用的数据量较大，因此 **未随代码一同提交**。

示例数据来源：
- https://github.com/Anduin2017/HowToCook

你可以自行下载并放置到：

rag/data/

随后执行索引构建流程即可。

在实际使用中可以根据自己的需求替换为任意参考文档或领域数据，例如个人笔记、项目文档、知识库或其他结构化/非结构化文本。

---

## 🔑 API Key 配置

部分工具依赖第三方 API（例如 Tavily Web Search）。

请在项目根目录创建 `.env` 文件，并按如下方式配置：

```env
TAVILY_API_KEY="your-tavily-api-key"

